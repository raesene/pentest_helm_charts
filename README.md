# Pentest Helm Charts

These are some basic charts that could be useful on pentests or CTFs or similar.  Please note that they are **not** intended for use on production clusters as they tend to do things in insecure ways, by design.

If you're looking for more information on helm security and how to attack it during a penetration test or CTF, read these articles from [bitnami](https://engineering.bitnami.com/articles/helm-security.html) and [ropnop](https://blog.ropnop.com/attacking-default-installs-of-helm-on-kubernetes/)

## privchart

Basic chart with a deployment based on a single busybox image which is deployed as a privileged container. Won't work if the cluster has PodSecurityPolicies in place, as they *should* block the techniques it uses.

### Usage

`helm install ./privchart-0.1.0.tgz` then find the pod with `kubectl get po` and exec into it.  then run `chroot /host` to get a full root shell on the underlying cluster node.

## privsshchart

Similar to `privchart` but this starts an SSH server in the pod with a hardcoded root password of `reallyinsecure`, and creates a service with a NodePort for that SSH daemon.  Handy where you have access to Tiller but don't have kubectl access.

### Usage

`helm install ./privsshchart-0.1.0.tgz` . Take node of the NodePort assigned then `ssh -p [nodeport] root@[IP]`, pass in the password noted above and then `chroot /host` to get a full root shell on the node